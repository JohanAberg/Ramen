// License here

#include<ramen/hash/goulburn.hpp>

#include<cmath>

namespace ramen
{
namespace hash
{

const goulburn_t::value_type goulburn_t::max_value = 0xFFFFFFFF;
const goulburn_t::value_type goulburn_t::g_table0[256] =
{
4143812366,2806512183,4212398656,393834663,
3943187971,847901099,3746904015,2990585247,
4243977488,4075301976,2737181671,2429701352,
4196558752,3152011060,1432515895,204108242,
1180540305,922583281,1734842702,1453807349,
507756934,1553886700,2005976083,3346025117,
97642817,2510760451,4103916440,3222467334,
1312447049,522841194,3955607179,3028936967,
2763655970,3033075496,1935362065,512912210,
2660383701,1652921526,260485165,141882627,
2895806269,804034013,1356707616,3942447612,
2875374199,81028672,1055595160,2755907176,
2880512448,1232977841,3719796487,2940441976,
3739585976,168332576,1318372270,3173546601,
3992298512,3785690335,3667530757,3101895251,
2789438017,3213463724,3067100319,2554433152,
794184286,2599814956,1251486151,4214997752,
690900134,323888098,1537487787,1155362310,
1826165850,2358083425,2957662097,2514517438,
1828367703,3847031274,2308450901,955547506,
1037823031,2922505570,2544914051,2572931499,
442837508,1873354958,2004376537,25413657,
3560636876,1768043132,2870782748,1031556958,
715180405,201079975,4116730284,2748714587,
1091411202,33354499,1931487277,1039106939,
3327011403,396608379,3447523131,301432924,
3180185526,1780290520,3909968679,2398211959,
3704875308,66082280,601805180,3226323057,
3284786200,2282257088,700775591,3528928994,
1601645543,120115228,568698020,178214456,
41846783,897656032,3309570546,2624714322,
2542948622,1168171675,2460933760,93808223,
2384991231,4268721795,4001720080,1516739672,
4111847489,810915309,1238071781,935043360,
2020231594,37717498,3603218947,1534593867,
2819275526,1965883441,674162751,128087286,
4138356188,543626850,1355906380,3565721429,
1142978716,1614752605,1624389156,3363454971,
2029311310,2249603714,3448236784,1764058505,
2198836711,3481576182,3168665556,3834682664,
1979945243,3456525349,2721891322,1099639387,
1528675965,3069012165,1807951214,1901014398,
2805656341,3321210152,2317543573,1015607418,
178584554,4020226276,492648819,97778844,
4134244261,1389599433,331211243,3769684011,
2036127367,3174548433,3241354897,2570869934,
3071842004,1972073698,48467379,1015444026,
3126762609,1104264591,3096375666,1380392409,
684368280,1493310388,2109527660,3034364089,
3168522906,3042350939,3696929834,3410250713,
3726870750,3357455860,1816295563,2678332086,
26178399,614899533,2248041911,1431155883,
1184971826,3711847923,2744489682,168580352,
694400736,2659092308,811197288,1093111228,
824677015,2041709752,1650020171,2344240270,
3773698958,3393428365,3498636527,556541408,
1883820721,3249806350,3635420446,1661145756,
3087642385,1620143845,3852949019,1054565053,
3574021829,2466085457,2078148836,460565767,
4097474724,1381665351,1652238922,2200252397,
3726797486,4001080204,259576503,567653141,
325219513,1227314237,3191441965,1433728871,
4198425173,2908977223,3757065246,294312130,
4136006097,3409363054,2112383431,1177366649
};
const goulburn_t::value_type goulburn_t::g_table1[128] =
{
826524031,360568984,3001046685,1511935255,
1287825396,3167385669,1488463483,4077470910,
1360843071,986771770,2307292828,3845679814,
1429883439,1990257475,4087625806,1700033651,
1388994450,935547107,3237786789,644530675,
2274037095,888755779,3020158166,2136355264,
2558959443,1751931693,2325730565,3029134627,
668542860,2140243729,2384660990,666440934,
842610975,1563602260,1429103271,899918690,
3441536151,4078621296,1527765522,4191433361,
222526771,309447417,2035245353,3730203536,
3330019758,876252573,2545027471,453932528,
282738293,1826993794,1569532013,543681326,
3097574376,2336551794,1563241416,1127019882,
3088670038,2766122176,3706267663,1110947226,
2608363541,3166834418,1310161541,755904436,
2922000163,3815555181,1578365408,3137960721,
3254556244,4287631844,750375141,1481489491,
1903967768,3684774106,765971482,3225162750,
2946561128,1920278401,1803486497,4166913456,
1855615192,1934651772,1736560291,2101779280,
3560837687,3004438879,804667617,2969326308,
3118017313,3090405800,566615197,2451279063,
4029572038,2612593078,3831703462,914594646,
2873305199,2860901605,3296630085,1273702937,
2852911938,1003268745,1387783190,159227777,
2211994285,28095103,3659848176,3976935977,
3301276082,2641346573,651238838,2264520966,
1484747269,3016251036,3857206301,91952846,
1662449304,2028491746,1613452911,2409055848,
1453868667,4146146473,1646176015,3769580099,
3171524988,2980516679,828895558,3384493282
};

float goulburn_t::gauss_rand( float v) const
{
    float seed = 0.177;
    float x;		// Note: to avoid numerical problems with very small
    float y;		// numbers, we make these variables singe-precision
    float length2;	// floats, but later we call the double-precision log()
                    // and sqrt() functions instead of logf() and sqrtf().
    do
    {
        x = ((*this)( v, seed) - 0.5f) * 2.0f;
        seed += 2.0f * seed;

        y = ((*this)( v, seed) - 0.5f) * 2.0f;
        seed += seed + 0.111f;

        length2 = x * x + y * y;
    }
    while( length2 >= 1 || length2 == 0);

    return x * std::sqrt( -2.0 * std::log( double (length2)) / length2);
}

} // math
} // ramen
